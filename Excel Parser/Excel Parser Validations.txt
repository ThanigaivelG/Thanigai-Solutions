declare
  v_rownum number := 0;
  v_err_msg clob;
begin   

    if :P61_EXCEL_UPLOAD is null then
       raise_application_error(-20001,'Please Select any file to upload....');
    end if;
  
     for r1 in (select * from
                    apex_application_temp_files f, table( apex_data_parser.parse(
                                    p_content                     => f.blob_content,
                                    p_add_headers_row             => 'Y',
                                    p_file_name                   => f.filename,
                                    p_skip_rows => 1 ) ) p    
                    where f.name = :P61_EXCEL_UPLOAD  --Page Item name
                    )
        loop   
        
        v_rownum := v_rownum + 1;

        if r1.col001 is null then
          v_err_msg := v_err_msg || '<br/>Employee Number is null at row : ' || v_rownum;
        end if;          
        
        if r1.col002 is null then
          v_err_msg := v_err_msg || '<br/>Employee Name is null at row : ' || v_rownum ;
        end if;
        
        if r1.col003 is null then
          v_err_msg := v_err_msg || '<br/>Employee Designation is null at row : ' || v_rownum ;
        end if; 

           insert into EXCEL_UPLOAD values (r1.col001,r1.col002,r1.col003);
 
        END LOOP;   

        if v_err_msg is not null then
          raise_application_error(-20001,v_err_msg);
        end if;
  end;      
       